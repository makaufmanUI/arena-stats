import streamlit as st
from functions import *
import matplotlib.pyplot as plt


INPUT_TEXT = """
isRanked,startTime,endTime,zoneId,duration,teamName,teamColor,winnerColor,teamPlayerName1,teamPlayerName2,teamPlayerName3,teamPlayerName4,teamPlayerName5,teamPlayerClass1,teamPlayerClass2,teamPlayerClass3,teamPlayerClass4,teamPlayerClass5,teamPlayerRace1,teamPlayerRace2,teamPlayerRace3,teamPlayerRace4,teamPlayerRace5,oldTeamRating,newTeamRating,diffRating,mmr,enemyOldTeamRating,enemyNewTeamRating,enemyDiffRating,enemyMmr,enemyTeamName,enemyPlayerName1,enemyPlayerName2,enemyPlayerName3,enemyPlayerName4,enemyPlayerName5,enemyPlayerClass1,enemyPlayerClass2,enemyPlayerClass3,enemyPlayerClass4,enemyPlayerClass5,enemyPlayerRace1,enemyPlayerRace2,enemyPlayerRace3,enemyPlayerRace4,enemyPlayerRace5,enemyFaction
YES,1668979677,1668979814,559,137,,GREEN,GOLD,Cope,Drpain,,,,DEATHKNIGHT,DEATHKNIGHT,,,,HUMAN,HUMAN,,,,1223,1212,-11,1240,1272,1283,11,1251,,Grumpylunkns-Whitemane,Limpyllama-Whitemane,,,,DRUID,PRIEST,,,,TAUREN,UNDEAD,,,,HORDE,
YES,1668979903,1668980024,562,121,,GREEN,GOLD,Cope,Drpain,,,,DEATHKNIGHT,DEATHKNIGHT,,,,HUMAN,HUMAN,,,,1212,1200,-12,1215,1185,1201,16,1215,,Initially-Eranikus,Lichqueén-Eranikus,,,,PALADIN,DEATHKNIGHT,,,,BLOODELF,BLOODELF,,,,HORDE,
YES,1668980024,1668980151,572,127,,GOLD,GOLD,Cope,Drpain,,,,DEATHKNIGHT,DEATHKNIGHT,,,,HUMAN,HUMAN,,,,1200,1212,12,1188,1160,1149,-11,1190,,Shankmor-Eranikus,Summonlight-Eranikus,,,,ROGUE,PALADIN,,,,UNDEAD,BLOODELF,,,,HORDE,
YES,1668980152,1668980336,562,184,,GREEN,GOLD,Cope,Drpain,,,,DEATHKNIGHT,DEATHKNIGHT,,,,HUMAN,HUMAN,,,,1213,1201,-12,1215,1236,1247,11,1220,,Eldredx-Grobbulus,Holybeast-Grobbulus,,,,ROGUE,PALADIN,,,,HUMAN,HUMAN,,,,ALLIANCE,
YES,1668980336,1668980460,617,124,,GREEN,GREEN,Cope,Drpain,,,,DEATHKNIGHT,DEATHKNIGHT,,,,HUMAN,HUMAN,,,,1201,1212,11,1189,1138,1128,-10,1183,,Benjackinit-Sulfuras,Lemonshock-Sulfuras,,,,MAGE,SHAMAN,,,,GNOME,DRAENEI,,,,ALLIANCE,
YES,1668980460,1668980637,562,177,,GOLD,GOLD,Cope,Drpain,,,,DEATHKNIGHT,DEATHKNIGHT,,,,HUMAN,HUMAN,,,,1214,1226,12,1215,1176,1165,-11,1205,,Kyry-OldBlanchy,Lovestospoge-OldBlanchy,,,,DRUID,SHAMAN,,,,TAUREN,TROLL,,,,HORDE,
YES,1668980637,1668980799,562,162,,GOLD,GOLD,Drpain,Cope,,,,DEATHKNIGHT,DEATHKNIGHT,,,,HUMAN,HUMAN,,,,1228,1247,19,1240,866,866,0,1384,,Deathrollz-Benediction,Whortitude-Benediction,,,,WARRIOR,PRIEST,,,,HUMAN,NIGHTELF,,,,ALLIANCE,
YES,1668980799,1668981169,617,370,,GOLD,GREEN,Cope,Drpain,,,,DEATHKNIGHT,DEATHKNIGHT,,,,HUMAN,HUMAN,,,,1249,1238,-11,1280,1330,1340,10,1284,,Dkwhopper-Eranikus,Tootybooty-Eranikus,,,,DEATHKNIGHT,PRIEST,,,,BLOODELF,UNDEAD,,,,HORDE,
YES,1668981170,1668981319,572,149,,GREEN,GOLD,Cope,Drpain,,,,DEATHKNIGHT,DEATHKNIGHT,,,,HUMAN,HUMAN,,,,1238,1226,-12,1255,1087,1129,42,1252,,Mindmandarin-Benediction,Rhapsodyx-Benediction,,,,PALADIN,DEATHKNIGHT,,,,HUMAN,HUMAN,,,,ALLIANCE,
YES,1668981320,1668981439,559,119,,GOLD,GOLD,Cope,Drpain,,,,DEATHKNIGHT,DEATHKNIGHT,,,,HUMAN,HUMAN,,,,1226,1238,12,1228,1233,1221,-12,1228,,Bruiñ-Benediction,Ectriir-Benediction,,,,DRUID,HUNTER,,,,NIGHTELF,NIGHTELF,,,,ALLIANCE,
YES,1669084384,1669084472,617,88,,GREEN,GREEN,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1297,1309,12,1290,1284,1272,-12,1287,,Bowadin-Mankrik,Haikudied-Mankrik,,,,PALADIN,DEATHKNIGHT,,,,BLOODELF,ORC,,,,HORDE,
YES,1669084472,1669084659,617,187,,GOLD,GOLD,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1309,1323,14,1316,1298,1287,-11,1331,,Kånye-Whitemane,Skîp-Whitemane,,,,ROGUE,PALADIN,,,,UNDEAD,BLOODELF,,,,HORDE,
YES,1669084659,1669084969,572,310,,GREEN,GOLD,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1322,1311,-11,1345,1393,1403,10,1354,,Desttripador,Leopardd,,,,WARRIOR,PALADIN,,,,HUMAN,HUMAN,,,,ALLIANCE,
YES,1669084969,1669085131,572,162,,GREEN,GREEN,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1311,1325,14,1320,1255,1245,-10,1328,,Byrndrop-Sulfuras,Fluabu-Sulfuras,,,,PRIEST,DRUID,,,,HUMAN,NIGHTELF,,,,ALLIANCE,
YES,1669085131,1669085346,562,215,,GREEN,GREEN,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1325,1340,15,1347,1377,1364,-13,1348,,Avelorà-Benediction,Fingersteak-Benediction,,,,PRIEST,DRUID,,,,HUMAN,NIGHTELF,,,,ALLIANCE,
YES,1669085346,1669085916,572,570,,GREEN,GREEN,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1340,1357,17,1374,1347,1336,-11,1370,,Bigdaddý-Faerlina,Gampi-Faerlina,,,,WARRIOR,PALADIN,,,,ORC,BLOODELF,,,,HORDE,
YES,1669085916,1669086147,572,231,,GREEN,GOLD,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1357,1346,-11,1399,1374,1388,14,1385,,Togepi-Benediction,Puppylion-Benediction,,,,PALADIN,HUNTER,,,,HUMAN,NIGHTELF,,,,ALLIANCE,
YES,1669086147,1669086361,562,214,,GREEN,GOLD,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1346,1335,-11,1371,1386,1397,11,1370,,Xpn-Grobbulus,Oeii-Grobbulus,,,,DEATHKNIGHT,PRIEST,,,,ORC,UNDEAD,,,,HORDE,
YES,1669086361,1669086501,559,140,,GOLD,GOLD,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1335,1348,13,1345,1283,1273,-10,1337,,Moolander,Snarff,,,,DRUID,DEATHKNIGHT,,,,TAUREN,ORC,,,,HORDE,
YES,1669086501,1669086691,617,190,,GOLD,GOLD,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1348,1363,15,1370,1372,1360,-12,1364,,Billybuffalo-Whitemane,Nefi-Whitemane,,,,MAGE,PRIEST,,,,UNDEAD,BLOODELF,,,,HORDE,
YES,1669086691,1669086981,562,290,,GREEN,GREEN,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1363,1380,17,1395,1430,1417,-13,1406,,Boshea-Eranikus,Slimreap-Eranikus,,,,ROGUE,MAGE,,,,UNDEAD,UNDEAD,,,,HORDE,
YES,1669086981,1669087172,559,191,,GOLD,GREEN,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1381,1370,-11,1423,1432,1444,12,1422,,Quikseven-Sulfuras,Drinkbooze-Sulfuras,,,,PRIEST,SHAMAN,,,,DRAENEI,DRAENEI,,,,ALLIANCE,
YES,1669087172,1669087314,617,142,,GOLD,GOLD,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1370,1386,16,1397,1412,1399,-13,1401,,Christus-Pagle,Loganitus-Pagle,,,,PRIEST,WARRIOR,,,,HUMAN,HUMAN,,,,ALLIANCE,
YES,1669087314,1669087746,617,432,,GOLD,GOLD,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1387,1404,17,1423,1368,1358,-10,1423,,Akiopal-Windseeker,Ratmovie-Windseeker,,,,PALADIN,WARRIOR,,,,BLOODELF,ORC,,,,HORDE,
YES,1669087746,1669089042,617,1296,,GOLD,GOLD,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1404,1432,28,1450,948,948,0,1685,,Jvsxn-Benediction,Tankokingg-Benediction,,,,ROGUE,PALADIN,,,,HUMAN,HUMAN,,,,ALLIANCE,
YES,1669089043,1669089234,562,191,,GOLD,GREEN,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1432,1423,-9,1494,1436,1459,23,1513,,Johnnybreeco-Faerlina,Urlacherx-Faerlina,,,,DRUID,PRIEST,,,,TAUREN,TROLL,,,,HORDE,
YES,1669089234,1669089512,572,278,,GOLD,GREEN,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1423,1413,-10,1471,1333,1369,36,1471,,Cheetos,Beatriz,,,,SHAMAN,PALADIN,,,,ORC,BLOODELF,,,,HORDE,
YES,1669089512,1669089797,559,285,,GREEN,GOLD,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1413,1402,-11,1445,1463,1474,11,1440,,Daddydivine-Sulfuras,Saketome-Sulfuras,,,,PALADIN,WARRIOR,,,,BLOODELF,TAUREN,,,,HORDE,
YES,1669089798,1669090293,559,495,,GOLD,GREEN,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1402,1391,-11,1418,1425,1437,12,1420,,Cannie-Benediction,Thebossheale-Benediction,,,,WARRIOR,PALADIN,,,,GNOME,HUMAN,,,,ALLIANCE,
YES,1669090293,1669090872,562,579,,GOLD,GOLD,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1391,1403,12,1392,1342,1332,-10,1390,,Donaldj-Grobbulus,Malamis-Grobbulus,,,,WARRIOR,DRUID,,,,HUMAN,NIGHTELF,,,,ALLIANCE,
YES,1669090872,1669091134,572,262,,GREEN,GREEN,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1403,1417,14,1418,1419,1407,-12,1424,,Littlej-Benediction,Vysenya-Benediction,,,,MAGE,PRIEST,,,,HUMAN,HUMAN,,,,ALLIANCE,
YES,1669091134,1669091282,562,148,,GOLD,GOLD,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1418,1434,16,1445,1409,1398,-11,1448,,Blastingdk-Whitemane,Manbearpally-Whitemane,,,,DEATHKNIGHT,PALADIN,,,,TROLL,BLOODELF,,,,HORDE,
YES,1669091282,1669091490,562,208,,GREEN,GOLD,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1434,1423,-11,1472,1492,1503,11,1459,,Nhojx-Mankrik,Roons-Mankrik,,,,PRIEST,MAGE,,,,UNDEAD,UNDEAD,,,,HORDE,
YES,1669091490,1669091671,572,181,,GOLD,GOLD,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1423,1438,15,1444,1405,1394,-11,1440,,Flexso-Sulfuras,Watchxlearn-Sulfuras,,,,PRIEST,DEATHKNIGHT,,,,UNDEAD,ORC,,,,HORDE,
YES,1669091671,1669091927,617,256,,GOLD,GREEN,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1438,1427,-11,1469,1479,1491,12,1477,,Rbko,Saiyana,,,,DRUID,PRIEST,,,,NIGHTELF,HUMAN,,,,ALLIANCE,
YES,1669091927,1669092247,572,320,,GOLD,GREEN,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1427,1416,-11,1444,1416,1432,16,1444,,Sanc-Grobbulus,Wxx-Grobbulus,,,,PALADIN,WARRIOR,,,,BLOODELF,ORC,,,,HORDE,
YES,1669092247,1669092459,562,212,,GOLD,GREEN,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1416,1404,-12,1418,1423,1435,12,1418,,Arenaslave-Benediction,Blizrdsuport-Benediction,,,,DRUID,PRIEST,,,,NIGHTELF,HUMAN,,,,ALLIANCE,
YES,1669092459,1669092769,562,310,,GOLD,GREEN,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1404,1392,-12,1392,1385,1398,13,1393,,Eldinora-Eranikus,Murderstein-Eranikus,,,,ROGUE,PRIEST,,,,HUMAN,HUMAN,,,,ALLIANCE,
YES,1669092769,1669092983,617,214,,GREEN,GOLD,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1392,1379,-13,1366,1439,1449,10,1373,,Kyogen-Grobbulus,Reyädon-Grobbulus,,,,PRIEST,ROGUE,,,,UNDEAD,UNDEAD,,,,HORDE,
YES,1669252113,1669252484,562,371,,GOLD,GREEN,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1379,1366,-13,1350,1338,1352,14,1352,,Dunkr-Grobbulus,Horndoggie-Grobbulus,,,,WARRIOR,DRUID,,,,TROLL,TAUREN,,,,HORDE,
YES,1669252485,1669253108,562,623,,GREEN,GREEN,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1366,1377,11,1324,1310,1298,-12,1332,,Blackthòrn-Grobbulus,Hotdog-Grobbulus,,,,PALADIN,WARRIOR,,,,HUMAN,HUMAN,,,,ALLIANCE,
YES,1669253108,1669253601,559,493,,GREEN,GREEN,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1377,1387,10,1352,1369,1356,-13,1332,,Ogruzin-Eranikus,Palabranco-Eranikus,,,,WARRIOR,PALADIN,,,,ORC,BLOODELF,,,,HORDE,
YES,1669253601,1669253922,617,321,,GOLD,GREEN,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1388,1375,-13,1375,1361,1375,14,1372,,Orvilledk-Whitemane,Raaged-Whitemane,,,,DEATHKNIGHT,PRIEST,,,,ORC,UNDEAD,,,,HORDE,
YES,1669253923,1669254217,559,294,,GOLD,GOLD,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1375,1386,11,1348,1353,1341,-12,1345,,Brocodex-Earthfury,Deadbutt-Earthfury,,,,PRIEST,DEATHKNIGHT,,,,HUMAN,HUMAN,,,,ALLIANCE,
YES,1669254217,1669254392,572,175,,GOLD,GOLD,Cope,Opsec,,,,DEATHKNIGHT,PALADIN,,,,HUMAN,HUMAN,,,,1386,1402,16,1374,943,943,0,1500,,Dhaverik-Earthfury,Rëkriah-Earthfury,,,,DEATHKNIGHT,SHAMAN,,,,HUMAN,DRAENEI,,,,ALLIANCE,
"""




st.set_page_config(page_title="Arena Stats",layout="centered",page_icon=":crossed_swords:")
df = parse_csv(INPUT_TEXT)
df = simplify_dataframe(df)
st.markdown("# Arena Stats")
st.markdown("---")

st.markdown("## Comp winrates")
st.markdown("---")
st.write("")
comp_winrates = calculate_comp_win_rates(df)
for comp, winrate in comp_winrates.items():
    if winrate > 0:
        st.write(f"{comp[0].title()}, {comp[1].title()} :  {winrate*100:.2f}%")

st.write("")


    
st.markdown("## Rating over time")
fig, ax = plt.subplots()
ratings = df['oldTeamRating'].astype(int)
ax.plot(ratings)
st.pyplot(fig)
